---
import Layout from "../layouts/Layout.astro";
import TunicwildsApp from "../components/Tunicwilds/Tunicwilds.svelte";
import db from "../database/db";
import { Tunicwild } from "../database/schema";

export const prerender = false;

if (
    import.meta.env.DEV
        ? !process.env.TUNICWILDS_UPLOAD_DIRECTORY
        : !process.env.TUNICWILDS_UPLOAD_URL
) {
    return new Response("TUNICWILDS env not set", { status: 500 });
}

const songList = await db
    .select({
        id: Tunicwild.id,
        composer: Tunicwild.composer,
        game: Tunicwild.game,
        officialLink: Tunicwild.officialLink,
        title: Tunicwild.title,
    })
    .from(Tunicwild);
---

<Layout
    title="Tunicwilds"
    description="CAN YOU GUESS THE SONG? CAN YOU GUESS THE GAME? CAN YOU GUESS THE TUNICWILDS?"
>
    <TunicwildsApp client:load {songList} />
</Layout>
